function e(){try{const e=document.cookie.split(";").find(e=>e.trim().startsWith("_ga="));if(e){const t=e.split(".");if(t.length>=4)return`${t[2]}.${t[3]}`}}catch(e){}}function t(){const e=navigator.userAgent;return/(tablet|ipad|playbook|silk)|(android(?!.*mobi))/i.test(e)?"tablet":/Mobile|Android|iP(hone|od)|IEMobile|BlackBerry|Kindle|Silk-Accelerated|(hpw|web)OS|Opera M(obi|ini)/.test(e)?"mobile":"desktop"}function n(){const e=navigator.userAgent;return e.indexOf("Win")>-1?"Windows":e.indexOf("Mac")>-1?"macOS":e.indexOf("Linux")>-1?"Linux":e.indexOf("Android")>-1?"Android":e.indexOf("iOS")>-1||e.indexOf("iPhone")>-1||e.indexOf("iPad")>-1?"iOS":"Unknown"}function o(){const e=window.innerHeight,t=document.documentElement.scrollHeight,n=(window.pageYOffset||document.documentElement.scrollTop)/(t-e)*100;return Math.min(Math.round(n),100)}function i(){const e=navigator;if(e.connection)return e.connection.effectiveType||e.connection.type}function r(r,s,a){const c=function(){const e=new URLSearchParams(window.location.search),t={};return e.forEach((e,n)=>{t[n]=e}),t}(),{browser:d,version:m}=function(){const e=navigator.userAgent;let t="Unknown",n="Unknown";return e.indexOf("Firefox")>-1?(t="Firefox",n=e.match(/Firefox\/([0-9.]+)/)?.[1]||"Unknown"):e.indexOf("SamsungBrowser")>-1?(t="Samsung Internet",n=e.match(/SamsungBrowser\/([0-9.]+)/)?.[1]||"Unknown"):e.indexOf("Opera")>-1||e.indexOf("OPR")>-1?(t="Opera",n=e.match(/(?:Opera|OPR)\/([0-9.]+)/)?.[1]||"Unknown"):e.indexOf("Trident")>-1?(t="Internet Explorer",n=e.match(/rv:([0-9.]+)/)?.[1]||"Unknown"):e.indexOf("Edge")>-1?(t="Edge (Legacy)",n=e.match(/Edge\/([0-9.]+)/)?.[1]||"Unknown"):e.indexOf("Edg")>-1?(t="Edge (Chromium)",n=e.match(/Edg\/([0-9.]+)/)?.[1]||"Unknown"):e.indexOf("Chrome")>-1?(t="Chrome",n=e.match(/Chrome\/([0-9.]+)/)?.[1]||"Unknown"):e.indexOf("Safari")>-1&&(t="Safari",n=e.match(/Version\/([0-9.]+)/)?.[1]||"Unknown"),{browser:t,version:n}}(),g=function(){const e=document.cookie.split(";").reduce((e,t)=>{const[n,o]=t.trim().split("=");return e[n]=o,e},{});return{fbp:e._fbp,fbc:e._fbc}}(),u=function(){try{return{landingPage:sessionStorage.getItem("landingPage")||void 0,previousPages:JSON.parse(sessionStorage.getItem("previousPages")||"[]"),sessionStart:parseInt(sessionStorage.getItem("sessionStart")||"0")||void 0}}catch{return{}}}(),l=new Date,f=u.sessionStart?Math.round((Date.now()-u.sessionStart)/1e3):void 0,w=u.sessionStart?Math.round((Date.now()-u.sessionStart)/1e3):0;return{lead:r,tracking:{submissionTimestamp:l.toISOString(),submissionDate:l.toLocaleDateString("en-AU"),submissionTime:l.toLocaleTimeString("en-AU"),submissionDayOfWeek:l.toLocaleDateString("en-AU",{weekday:"long"}),timezone:Intl.DateTimeFormat().resolvedOptions().timeZone,sessionDuration:f,sourcePage:window.location.href,pageTitle:document.title,formId:s,formType:a,referrer:document.referrer||"Direct",landingPage:u.landingPage,utmSource:c.utm_source,utmMedium:c.utm_medium,utmCampaign:c.utm_campaign,utmTerm:c.utm_term,utmContent:c.utm_content,gclid:c.gclid,gbraid:c.gbraid,wbraid:c.wbraid,fbclid:c.fbclid,fbp:g.fbp,fbc:g.fbc,deviceType:t(),operatingSystem:n(),browser:d,browserVersion:m,screenResolution:`${screen.width}x${screen.height}`,viewportSize:`${window.innerWidth}x${window.innerHeight}`,userAgent:navigator.userAgent,language:navigator.language,languages:navigator.languages?Array.from(navigator.languages):[navigator.language],connectionType:i(),scrollDepth:o(),timeOnPage:w,previousPages:u.previousPages,gaClientId:e(),sessionId:sessionStorage.getItem("sessionId")||void 0,adPosition:c.position,keyword:c.keyword,matchType:c.matchtype,network:c.network,placement:c.placement,deviceModel:c.device}}}!function(){try{if(sessionStorage.getItem("landingPage")||sessionStorage.setItem("landingPage",window.location.href),sessionStorage.getItem("sessionStart")||sessionStorage.setItem("sessionStart",Date.now().toString()),!sessionStorage.getItem("sessionId")){const e=`${Date.now()}-${Math.random().toString(36).substr(2,9)}`;sessionStorage.setItem("sessionId",e)}const e=JSON.parse(sessionStorage.getItem("previousPages")||"[]");e.includes(window.location.href)||(e.push(window.location.href),sessionStorage.setItem("previousPages",JSON.stringify(e)));const t=new URLSearchParams(window.location.search);["utm_source","utm_medium","utm_campaign","utm_term","utm_content","gclid","fbclid"].forEach(e=>{const n=t.get(e);n&&!sessionStorage.getItem(e)&&sessionStorage.setItem(e,n)})}catch(e){}}();const s=document.getElementById("mainQuoteForm");s&&s.addEventListener("submit",async e=>{e.preventDefault();const t=s.querySelector('button[type="submit"]'),n=t?.textContent||"";t&&(t.disabled=!0,t.textContent="SUBMITTING...");try{const e=new FormData(s),t={name:e.get("name"),email:e.get("email"),phone:e.get("phone"),suburb:e.get("suburb"),product:e.get("product"),bestTime:e.get("best-time")||void 0,message:e.get("message")||void 0},n=r(t,"mainQuoteForm","homepage-quote-form"),o=await fetch("/api/submit-lead",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)}),i=await o.json();if(!o.ok||!i.success)throw new Error(i.message||"Submission failed");"undefined"!=typeof gtag&&gtag("event","generate_lead",{event_category:"Form",event_label:t.product,value:1}),alert("Thank you! We'll contact you within 24 hours."),window.location.href="/thank-you"}catch(o){alert("There was an error submitting your form. Please try calling us directly at 0448 243 979."),t&&(t.disabled=!1,t.textContent=n)}});const a=document.getElementById("plantationQuoteBtn"),c=document.getElementById("blindsQuoteBtn");a&&a.addEventListener("click",()=>{const e=document.getElementById("mainQuoteForm"),t=document.getElementById("product");t&&(t.value="plantation-shutters"),e&&e.scrollIntoView({behavior:"smooth"})}),c&&c.addEventListener("click",()=>{const e=document.getElementById("mainQuoteForm"),t=document.getElementById("product");t&&(t.value="outdoor-blinds"),e&&e.scrollIntoView({behavior:"smooth"})});
